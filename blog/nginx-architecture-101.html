<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-CWBY2MRPEE"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-CWBY2MRPEE");
    </script>

    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "nkymcpvily");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Nginx 101: The Architecture That Powers Modern Websites | Shavin Anjitha
    </title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../assets/css/article.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <meta
      name="description"
      content="Web server software is a crucial piece of software in today’s world.
            From traditional Apache servers to modern, sophisticated ones, a few
            major web server software have secured their place on the World Wide
            Web. Nginx is one of the leading web servers today.
    "
    />
    <meta name="theme-color" content="#000000" />
    <meta
      name="keywords"
      content="Nginx, Web Server, Architecture, Software, HTTP, HTTP Server, Reverse Proxy, Software Architecture, Shavin Anjitha, Blog, Blog Article, Shavin Anjitha's Blog"
    />
    <meta name="author" content="Shavin Anjitha" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta
      name="og:title"
      content="Nginx 101: The Architecture That Powers Modern Websites"
    />
    <meta
      name="og:description"
      content="Web server software is a crucial piece
    of software in today’s world. From traditional Apache servers to modern,
    sophisticated ones, a few major web server software have secured their place
    on the World Wide Web. Nginx is one of the leading web servers today."
    />
    <meta name="og:image" content="../assets/img/profile-ellipse.png" />
    <meta name="og:url" content="https://shavinanjitha.me" />
  </head>
  <body>
    <!-- <header>
      <div class="logo cursor-scale small">
        <img
          src="/assets/img/profile-ellipse.png"
          alt="Profile Picture"
          width="40"
        />
      </div>
      <nav>
        <a href="/index.html" class="active">HOME</a>
        <a href="#">LIBRARY</a>
        <a href="/index.html#blogs">BLOGS</a>
      </nav>
      <button id="dark-mode-toggle">&#9728;</button>
    </header> -->

    <div class="blog-header">
      <div class="blog-header-left">
        <div class="logo">
          <a href="/index.html">
            <img
              src="../assets/img/avatar.webp"
              alt="Profile Picture"
              width="40"
            />
          </a>
        </div>
        <h1 id="blog-link">Blog</h1>

        <h2 class="title">
          Nginx 101: The Architecture That Powers Modern Websites
        </h2>
      </div>

      <button id="dark-mode-toggle">&#9728;</button>
    </div>

    <div class="cover-image">
      <!-- <img src="../assets/img/pattern.webp" alt="Cover Image" /> -->

      <div class="article-header">
        <span class="block">BLOG</span>
        <span class="slash">/</span>
        <span class="article-title">
          Nginx 101: The Architecture That Powers Modern Websites
        </span>
      </div>

      <div class="article-container">
        <div class="social-icons">
          <a href="#" class="icon" id="share-linkedin">
            <i class="fa-brands fa-linkedin-in" style="color: orangered"></i>
          </a>
          <a href="#" class="icon" id="share-facebook">
            <i class="fa-brands fa-facebook-f" style="color: orangered"></i>
          </a>
          <a href="#" class="icon" id="share-x">
            <i class="fa-brands fa-twitter" style="color: orangered"></i>
          </a>
        </div>
        <div class="blog-content">
          <p class="date">13 Mar, 2024</p>
          <h1 class="title">
            Nginx 101: The Architecture That Powers Modern Websites
          </h1>

          <div class="article-author">
            <img
              class="author-image"
              src="/assets/img/avatar.webp"
              alt="Author Image"
              width="70px"
              height="70px"
            />
            <div class="author-details">
              <p class="author-name">Shavin Anjitha</p>
              <p class="author-description">Software Engineer</p>
            </div>
          </div>

          <img
            class="featured-image"
            src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*92R0KBl_HnUzFUZuY61Xjg.png"
            alt="Featured Image"
          />

          <p>
            Web server software is a crucial piece of software in today’s world.
            From traditional Apache servers to modern, sophisticated ones, a few
            major web server software have secured their place on the World Wide
            Web. Nginx is one of the leading web servers today.
          </p>

          <p>
            Nginx, pronounced as ‘engine X’, is a high-performance, lightweight,
            highly concurrent web server that can also be used as a reverse
            proxy, load balancer and HTTP cache. The nginx was written by a
            Russian developer named Igor Sysoev to address the problem known as
            the C10k problem, which aimed to optimize network sockets to handle
            a larger number of clients at the same time. (handling thousands of
            concurrent connections is a different problem from handling many
            requests per second). This problem was created by Daniel Kegel, a
            prominent software engineer, to address the increasing demands of
            web services in 1990. When server hardware, operating systems, and
            network resources become major constraints for website growth, many
            developers worldwide look for ways to optimize web servers to handle
            a large number of connections. Nginx has proven to be one of the
            most successful solutions to this problem. Development began in
            2002, and Igor released the first public version of Nginx in 2004
            after two years of active development.
          </p>

          <p>
            Nginx is free and open-source server software released under the
            terms of the 2-clause BSD license. In 2011, a company named Nginx
            Inc. was founded by Igor and Maxim Konovalov to provide commercial
            support for Nginx and NGINX Plus, which is paid software with
            advanced features. Nginx Inc. was acquired by F5 Inc. in March 2019.
            By 2024, Nginx secured first place in the server competition,
            surpassing Apache.
          </p>

          <img
            src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*w_co1wFu9riNOKgEBDB_jw.png"
            alt="Nginx Architecture"
          />

          <p>
            The Nginx codebase is entirely original and was written from scratch
            in the C language. Nginx has its own libraries and, with its
            standard modules, does not use much beyond the system’s C library,
            except for zlib, PCRE, and OpenSSL. It’s worth mentioning that
            Nginx’s compatibility with the Windows environment is quite poor.
            Certain limitations of Nginx and the Windows kernel architecture led
            to poor performance, no caching, and no bandwidth policies.
          </p>

          <h2>Features of Nginx</h2>

          <p>
            The first version of Nginx was primarily developed to serve static
            content and was deployed alongside Apache. Throughout its
            development, Nginx has added integration with other features.
          </p>

          <p>
            One of the main features of Nginx is its ability to handle more than
            10,000 simultaneous connections with a low memory footprint
            (approximately 2.5 MB per inactive 10,000 HTTP keep-alive
            connections). In addition to that, Nginx provides features primarily
            in three areas. These are,
          </p>

          <ol>
            <li>HTTP server features</li>
            <li>Mail proxy server features.</li>
            <li>Generic TCP/UDP proxy server features</li>
          </ol>

          <p>
            Nginx primarily acts as a reverse proxy, load balancer, and HTTP
            cache under HTTP server features. It also supports file indexing,
            and autoindexing, and serves dynamic content using FastCGI and SCGI
            handlers for scripts. Nginx is capable of handling HTTP/2 as well as
            HTTP/3 traffic. It supports HTTPS via SSL and TLS SNI. Other main
            features supported by nginx include URL redirection, URL rewriting,
            keep-alive and pipelined connections, redirections for 3xx and 5xx
            error codes, as well as FLV and MP4 streaming.
          </p>

          <p>
            Nginx can be used as a mail proxy server to redirect users to IMAP
            and POP3 servers using an external HTTP authentication server.
          </p>

          <p>
            In addition to serving as a specific HTTP server, Nginx can also act
            as a generic TCP/UDP proxy server with full SSL, TLS SNI support,
            and load balancing. It also supports access control based on client
            address.
          </p>

          <h2>Architecture of the Nginx</h2>

          <img
            src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*rq4CV3DOhF5G2lV0jVm_PA.png"
            alt="Nginx Architecture"
          />

          <p>
            Apache, the web server that still largely dominates the Internet
            today, has its roots in the early 1990s, when architecture matched
            then-existing operating systems and hardware. However, by the start
            of 2000, it was obvious that the standalone web server architecture
            did not scale well with the non-linear scalability of websites and
            web services. Apache was architected to spawn a copy of itself for
            each new connection, which was not suitable for growing web
            services. Eventually, Apache becomes a general-purpose web server
            with rich collections of third-party extensions and tools. But the
            problem remains the same: Apache is less scalable at that time
            because of increased CPU and memory overhead per connection.
          </p>

          <p>
            Nginx was written with a different architecture in mind, one which
            is much more suitable for non-linear scalability in both
            simultaneous connections and requests for seconds. The result is a
            <strong
              >modular event-driven asynchronous single-threaded non-blocking
              architecture </strong
            >, which became the foundation of the nginx core.
          </p>

          <p>
            Unlike traditional multi-threaded/multi-processed web servers, which
            span separate processes or threads for each new connection with
            run-time overhead, nginx uses a small number of
            <strong>worker processes</strong> to handle multiple concurrent
            connections. This worker process model is scaled efficiently in
            multi-core systems by attaching separate worker processes per core,
            allowing full utilization of multi-core architecture.
          </p>

          <p>
            Nginx works under the <strong> master-worker architecture</strong>,
            which consists of a single master process that manages one or more
            worker processes.
          </p>

          <img
            src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*J386DpkmNICwIis1FVlgrw.png"
            alt="Nginx Architecture"
          />

          <p>
            Three main components need to handle each connection that comes to
            the server, which are:
          </p>

          <ol>
            <li>
              <strong>Worker processes:</strong> responsible for handling
              incoming client connections and processing requests. Each process
              is single-threaded and non-blocking, and they communicate via
              shared memory and shared cached data.
            </li>
            <li>
              <strong>Event loop</strong>: Each worker process runs an event
              loop that listens for events and schedules tasks accordingly. This
              is the most complicated part of the Nginx core. event loop heavily
              relies on asynchronous task handling. The key principle of the
              event loop is to be as non-blocking as possible (unless there is
              no more disk storage performance).
            </li>

            <li>
              <strong>Event notification mechanism</strong> — uses
              platform-specific notification mechanism to monitor file
              descriptors for new events.
            </li>
          </ol>

          <p>
            Because Nginx does not fork processes or threads per connection,
            memory usage is very conservative and extremely efficient. It also
            conserves CPU cycles by not intervening in the ongoing cycle of
            creating and destroying processes and threads.
          </p>

          <p>
            In addition to worker processes and master processes, there are a
            few small processes for managing the caching process of the server,
            which are the <strong>Cache loader process</strong> and the
            <strong>Cache manager process</strong>.
          </p>

          <ol>
            <li>
              <strong>The cache loader process</strong> → runs at startup to
              load disk-based cache into the memory.
            </li>
            <li>
              <strong> The cache manager process</strong> → runs periodically
              and prunes entries from the disk to keep them at the configured
              size.
            </li>
          </ol>

          <p>
            Here is an image of a terminal screenshot showing the running master
            and worker processes of the nginx server:
          </p>

          <img
            src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*qt8oABreLyZt3ztmWx1FOQ.png"
            alt="Nginx Architecture"
          />

          <h2>Nginx process roles</h2>

          <h3>1. Master process</h3>

          <p>
            <strong
              >runs as the root user, which is responsible for following tasks,
            </strong>
          </p>

          <ol>
            <li>Reading and validating configurations.</li>
            <li>Creating, binding and closing sockets</li>
            <li>
              starting, terminating, and maintaining the configured number of
              worker processes.
            </li>
            <li>Reconfiguring without service interruption.</li>
            <li>Controlling non-stop binary upgrades.</li>
            <li>Reopening log files.</li>
            <li>Compiling embedded Perl scripts.</li>
          </ol>

          <h3>2. Worker process</h3>

          <p>
            The worker process is responsible for accepting, handling, and
            processing connections from clients. The connection handling process
            involves five main phases: Accept, Read, Process, Write, and Close.
            Worker processes are responsible for everything except handling from
            the master process and cache management.
          </p>

          <p>The following steps generally occur during connection handling:</p>

          <ol>
            <li>
              The worker waits for events on the listening and connection
              sockets.
            </li>

            <li>Events occur on the sockets, and the worker handles them.</li>
            <li>
              An event on the socket indicates that a client has initiated a new
              connection.
            </li>
            <li>
              An event on the connection indicates that a client has made a new
              request, and the worker process responds promptly.
            </li>
          </ol>

          <p>The typical HTTP request processing cycle follows these steps:</p>

          <ol>
            <li>The client sends an HTTP request.</li>
            <li>
              The nginx core selects the appropriate phase handler based on the
              configured location matching the request.
            </li>
            <li>
              If configured, a load balancer selects an upstream server for
              proxying.
            </li>
            <li>
              The phase handler processes the request and passes each output
              buffer to the first filter.
            </li>
            <li>
              The first filter passes the output to the second filter, and so
              on.
            </li>
            <li>The final response is then sent to the client.</li>
          </ol>

          <p>
            The modular architecture of Nginx allows developers to extend the
            web server's features without modifying its core. Nginx modules come
            in different flavors, namely core modules, event modules, phase
            modules, protocols, variable handlers, filters, upstream, and load
            balancers.
          </p>

          <p>
            Also, nginx provides a robust, scalable configuration system, as
            always required by web servers. With inspiration from Igor’s
            experience with Apache, the nginx configuration was designed to
            simplify day-to-day operations and provide an easy means of
            expansion.
          </p>

          <p>
            The configuration files are initially read and verified by the
            master process, and a compiled read-only configuration file is
            available to the worker processes.
          </p>

          <h2>Lessons learned:</h2>

          <blockquote>
            When Igor Sysoev began developing Nginx, most of the software that
            powered the Internet already existed. The architecture of this
            software typically followed the definitions of legacy server and
            network hardware, operating systems, and the old Internet
            architecture in general. However, this didn’t deter Igor from
            believing that he could improve things in the area of web servers.
            So, while the first lesson might seem obvious, it is this:<strong>
              there is always room for improvement</strong
            >.
          </blockquote>

          <h1>Conclusions:</h1>

          <p>
            In conclusion, Nginx is a powerful and versatile web server that
            offers robust features for handling HTTP request processing. Its
            efficient core capabilities, including reverse proxying, load
            balancing, and HTTP caching, make it a valuable tool for web
            administrators seeking high-performance and reliable web server
            operations. Understanding and effectively utilizing Nginx’s
            capabilities is crucial for maintaining a responsive and scalable
            web infrastructure.
          </p>
        </div>
      </div>
    </div>

    <script src="../assets/js/article.js" />
  </body>
</html>
